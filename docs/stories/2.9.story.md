# Story 2.9: Build Reservoir Dashboard Interface

## Status
Draft

## Story
**As a** subscribed user,
**I want** a personalized dashboard showing my automation opportunities,
**so that** I can easily discover, save, and track relevant automations

## Acceptance Criteria
1. Dashboard displays personalized weekly discoveries
2. Discovery cards show automation details, difficulty, and impact
3. Filter and search functionality for browsing automations
4. Save/dismiss actions update user preferences
5. Progress overview shows implementation status
6. Quick stats display time saved and revenue impact
7. Mobile-responsive card layout with infinite scroll
8. Empty states guide users when no discoveries available

## Tasks / Subtasks
- [ ] Set up dashboard layout and structure (AC: 1, 7)
  - [ ] Create main dashboard component with responsive grid
  - [ ] Implement dashboard navigation and header
  - [ ] Set up mobile-first responsive layout
  - [ ] Configure dashboard routing and page structure
- [ ] Build discovery card component (AC: 2, 4)
  - [ ] Create reusable DiscoveryCard component with TypeScript types
  - [ ] Implement automation details display (title, description, ROI)
  - [ ] Add difficulty and impact visual indicators
  - [ ] Include save/dismiss action buttons with state management
- [ ] Implement personalized discovery feed (AC: 1, 8)
  - [ ] Integrate with backend discovery API using React Query
  - [ ] Implement personalization algorithm based on user profile
  - [ ] Add weekly discovery refresh mechanism
  - [ ] Create empty state components with helpful guidance
- [ ] Create filter and search functionality (AC: 3)
  - [ ] Build FilterPanel component with multi-select options
  - [ ] Implement real-time search with debounced API calls
  - [ ] Add filter state management with URL persistence
  - [ ] Include filter reset and preset options
- [ ] Build progress tracking overview (AC: 5)
  - [ ] Create ProgressWidget components for implementation status
  - [ ] Display completion statistics and milestones
  - [ ] Add progress visualization with charts
  - [ ] Implement progress data fetching and state management
- [ ] Implement quick stats display (AC: 6)
  - [ ] Create StatsCard components for metrics display
  - [ ] Show time saved and revenue impact calculations
  - [ ] Add visual progress indicators and trend charts
  - [ ] Implement real-time stats updates
- [ ] Add infinite scroll implementation (AC: 7)
  - [ ] Implement virtual scrolling for large discovery lists
  - [ ] Add loading skeletons and pagination logic
  - [ ] Optimize performance for mobile devices
  - [ ] Include pull-to-refresh functionality
- [ ] Mobile optimization and interactions (AC: 7)
  - [ ] Optimize card layouts for touch interactions
  - [ ] Implement swipe gestures for save/dismiss actions
  - [ ] Test responsive behavior across device sizes
  - [ ] Add haptic feedback for mobile interactions
- [ ] Testing and analytics integration (AC: 1-8)
  - [ ] Unit tests for dashboard components and state management
  - [ ] Integration tests for discovery feed and filtering
  - [ ] Analytics tracking for user engagement metrics
  - [ ] Performance testing for load times and scrolling

## Dev Notes
### Tech Stack Requirements
[Source: architecture/3-tech-stack.md]
- **Frontend Framework**: Next.js 14.x with App Router
- **Language**: TypeScript 5.x for type safety
- **Styling**: Tailwind CSS 3.x for responsive design
- **State Management**: Zustand for discovery and filter state
- **Data Fetching**: React Query for server state management
- **UI Components**: shadcn/ui for consistent design system

### Dashboard Architecture
[Source: architecture/9-frontend-architecture.md]
```
src/
├── components/
│   ├── dashboard/              # Dashboard-specific components
│   │   ├── DashboardLayout.tsx
│   │   ├── StatsOverview.tsx
│   │   ├── QuickActions.tsx
│   │   └── WelcomeHeader.tsx
│   ├── discovery/             # Discovery feed components
│   │   ├── DiscoveryFeed.tsx
│   │   ├── DiscoveryCard.tsx
│   │   ├── FilterPanel.tsx
│   │   ├── SearchBar.tsx
│   │   └── EmptyState.tsx
│   ├── progress/              # Progress tracking components
│   │   ├── ProgressOverview.tsx
│   │   ├── ProgressWidget.tsx
│   │   ├── ImplementationStatus.tsx
│   │   └── MilestoneTracker.tsx
│   └── ui/                    # Base UI components
│       ├── card.tsx
│       ├── badge.tsx
│       ├── skeleton.tsx
│       └── ...
├── stores/
│   ├── discoveryStore.ts      # Discovery state management
│   ├── filterStore.ts         # Filter and search state
│   └── progressStore.ts       # Progress tracking state
├── lib/
│   ├── services/
│   │   ├── discoveryService.ts # Discovery API integration
│   │   ├── userService.ts      # User preferences API
│   │   └── analyticsService.ts # Analytics tracking
│   └── hooks/
│       ├── useDiscoveries.ts   # Discovery data hook
│       ├── useFilters.ts       # Filter management hook
│       └── useProgress.ts      # Progress tracking hook
└── app/
    └── dashboard/
        ├── page.tsx            # Main dashboard page
        ├── loading.tsx         # Dashboard loading state
        └── error.tsx           # Dashboard error boundary
```

### Discovery Card Implementation
```typescript
// components/discovery/DiscoveryCard.tsx
interface DiscoveryCardProps {
  discovery: WeeklyDiscovery
  onSave: (id: string) => Promise<void>
  onDismiss: (id: string) => Promise<void>
  variant?: 'default' | 'compact'
}

export function DiscoveryCard({ discovery, onSave, onDismiss, variant = 'default' }: DiscoveryCardProps) {
  return (
    <Card className={cn("discovery-card", variant === 'compact' && "compact")}>
      <CardHeader>
        <div className="flex justify-between items-start">
          <Badge variant={getDifficultyVariant(discovery.difficulty)}>
            {discovery.difficulty}
          </Badge>
          <div className="flex gap-2">
            <Button size="sm" variant="outline" onClick={() => onDismiss(discovery.id)}>
              <X className="h-4 w-4" />
            </Button>
            <Button size="sm" onClick={() => onSave(discovery.id)}>
              <Bookmark className="h-4 w-4" />
            </Button>
          </div>
        </div>
        <CardTitle className="text-lg">{discovery.title}</CardTitle>
      </CardHeader>
      <CardContent>
        <p className="text-muted-foreground mb-4">{discovery.description}</p>
        <div className="grid grid-cols-2 gap-4">
          <div className="metric">
            <span className="text-sm text-muted-foreground">Time Saved</span>
            <p className="font-semibold">{discovery.timeSaved}</p>
          </div>
          <div className="metric">
            <span className="text-sm text-muted-foreground">ROI Impact</span>
            <p className="font-semibold text-green-600">{discovery.roiImpact}</p>
          </div>
        </div>
      </CardContent>
    </Card>
  )
}
```

### Discovery State Management
```typescript
// stores/discoveryStore.ts
interface DiscoveryStore {
  discoveries: WeeklyDiscovery[]
  savedDiscoveries: string[]
  dismissedDiscoveries: string[]
  loading: boolean
  error: string | null
  hasMore: boolean
  
  // Actions
  fetchDiscoveries: () => Promise<void>
  saveDiscovery: (id: string) => Promise<void>
  dismissDiscovery: (id: string) => Promise<void>
  loadMoreDiscoveries: () => Promise<void>
  refreshDiscoveries: () => Promise<void>
}

export const useDiscoveryStore = create<DiscoveryStore>((set, get) => ({
  discoveries: [],
  savedDiscoveries: [],
  dismissedDiscoveries: [],
  loading: false,
  error: null,
  hasMore: true,
  
  fetchDiscoveries: async () => {
    set({ loading: true, error: null })
    try {
      const discoveries = await discoveryService.getPersonalizedDiscoveries()
      set({ discoveries, loading: false })
    } catch (error) {
      set({ error: error.message, loading: false })
    }
  },
  
  saveDiscovery: async (id: string) => {
    await discoveryService.saveDiscovery(id)
    set(state => ({ 
      savedDiscoveries: [...state.savedDiscoveries, id] 
    }))
  }
}))
```

### Filter and Search Implementation
```typescript
// components/discovery/FilterPanel.tsx
const FILTER_OPTIONS = {
  difficulty: ['Beginner', 'Intermediate', 'Advanced'],
  category: ['Lead Management', 'Marketing', 'Admin', 'Client Communication'],
  timeSaved: ['1-2 hours', '3-5 hours', '6+ hours'],
  roiImpact: ['Low', 'Medium', 'High']
}

export function FilterPanel() {
  const { filters, setFilters, resetFilters } = useFilterStore()
  
  return (
    <Card className="filter-panel">
      <CardHeader>
        <div className="flex justify-between items-center">
          <CardTitle>Filters</CardTitle>
          <Button variant="ghost" size="sm" onClick={resetFilters}>
            Reset
          </Button>
        </div>
      </CardHeader>
      <CardContent className="space-y-4">
        {Object.entries(FILTER_OPTIONS).map(([key, options]) => (
          <FilterGroup 
            key={key}
            label={key}
            options={options}
            value={filters[key]}
            onChange={(value) => setFilters({ [key]: value })}
          />
        ))}
      </CardContent>
    </Card>
  )
}
```

### Mobile Responsive Design
- **Mobile First**: Start with 320px width, scale up
- **Breakpoints**: sm (640px), md (768px), lg (1024px), xl (1280px)
- **Card Layout**: Single column on mobile, 2-column on tablet, 3-column on desktop
- **Touch Targets**: Minimum 44px for buttons and interactive elements
- **Swipe Gestures**: Left swipe to save, right swipe to dismiss

### Performance Optimization
- **Virtual Scrolling**: Use `react-window` for large discovery lists
- **Image Optimization**: Next.js Image component with proper sizing
- **Data Fetching**: React Query with stale-while-revalidate strategy
- **Bundle Splitting**: Dynamic imports for dashboard components
- **Caching**: Service worker caching for offline discovery access

### Analytics Tracking
```typescript
// lib/services/analyticsService.ts
export const trackDiscoveryInteraction = (action: string, discoveryId: string, metadata?: object) => {
  analytics.track('Discovery Interaction', {
    action, // 'save', 'dismiss', 'view', 'filter'
    discoveryId,
    timestamp: new Date().toISOString(),
    ...metadata
  })
}

// Usage in components
onSave={(id) => {
  trackDiscoveryInteraction('save', id, { source: 'dashboard' })
  return discoveryStore.saveDiscovery(id)
}}
```

### Testing Strategy
[Source: architecture/13-testing-strategy.md]
- **Unit Tests**: Discovery card interactions, filter logic, state management
- **Integration Tests**: Dashboard data flow, API integration, user preferences
- **E2E Tests**: Complete discovery journey from login to implementation
- **Performance Tests**: Dashboard load time, infinite scroll performance
- **Accessibility Tests**: Keyboard navigation, screen reader compatibility

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-08-17 | 1.0 | Initial story creation | Bob (Scrum Master) |
| 2025-08-17 | 2.0 | Standardized to template format with comprehensive Dev Notes | Kevin (Product Owner) |

## Dev Agent Record
### Agent Model Used
_To be filled by dev agent_

### Debug Log References
_To be filled by dev agent_

### Completion Notes List
_To be filled by dev agent_

### File List
_To be filled by dev agent_

## QA Results
_To be filled by QA agent_